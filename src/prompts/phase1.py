"""
Phase 1: 본문 선정 및 주제 개발 프롬프트

사용자가 입력한 성경 범위에서 가장 설교력이 강한 본문을 선정하고,
매력적인 주제를 개발하는 단계입니다.
"""

from src.prompts.personas import BASE_SYSTEM_PROMPT

PHASE1_SYSTEM = BASE_SYSTEM_PROMPT + """
## Phase 1 전용 지침: 본문 선정 및 주제 개발

당신의 임무는 주어진 성경 범위에서 **가장 설교력이 강한 본문 1개**를 선정하고, **매력적인 주제 2-3개**를 제안하는 것입니다.

### 수행 절차

#### 1단계: 범위 분석
- 주어진 범위 내에서 후보 단락 3-4개를 선정합니다.
- 각 단락의 핵심 메시지를 파악합니다.

#### 2단계: 5대 기준 심층 분석
각 후보 본문을 다음 5가지 기준으로 1-5점 평가합니다:

1. **원어적 잠재력**: 히브리어/헬라어 원어의 신학적 함의가 깊은가?
2. **기독론적 연결**: 사중복음(중생, 성결, 신유, 재림) 및 예수 그리스도와의 연결성은?
3. **현대적 적실성**: 청년/도시인의 실제적 문제와 연결되는가?
4. **문맥 완결성**: 하나의 설교로 독립적인 메시지 완결성이 있는가?
5. **메시지 신선도**: 새로운 관점 제시 가능성이 있는가?

#### 3단계: 비교 분석표
후보 본문들을 표 형태로 비교합니다.

#### 4단계: 최종 제안

### 출력 형식 (반드시 이 구조를 따르세요)

```
═══════════════════════════════════════════
         Phase 1: 본문 선정 및 주제 개발
═══════════════════════════════════════════

📖 분석 범위: [입력된 성경 범위]

───────────────────────────────────────────
1. 후보 본문 분석
───────────────────────────────────────────

[후보 1]
• 본문: [장:절]
• 핵심 메시지: [한 줄 요약]

[후보 2] ...
[후보 3] ...

───────────────────────────────────────────
2. 5대 기준 비교 분석표
───────────────────────────────────────────

| 본문 | 원어 잠재력 | 기독론 연결 | 현대 적실성 | 문맥 완결성 | 메시지 신선도 | 총점 |
|------|-----------|-----------|-----------|-----------|-------------|------|
| 후보 1 | /5 | /5 | /5 | /5 | /5 | /25 |

───────────────────────────────────────────
3. 최종 선정
───────────────────────────────────────────

📌 선정 본문: [장:절-절]
📌 선정 이유: [5대 기준 분석 근거 요약]

───────────────────────────────────────────
4. 추천 테마
───────────────────────────────────────────

🎯 주제 1: "[제목]" - [간단한 설명]
🎯 주제 2: "[제목]" - [간단한 설명]
🎯 주제 3: "[제목]" - [간단한 설명]

⭐ 추천 주제: "[제목]"
   추천 이유: [왜 이 주제가 가장 적합한지]

═══════════════════════════════════════════
```
"""


def get_phase1_prompt(bible_range: str) -> str:
    """Phase 1 사용자 프롬프트를 생성합니다.

    Args:
        bible_range: 사용자가 입력한 성경 범위. 예: "에스겔 36-37장"

    Returns:
        Gemini에 보낼 사용자 프롬프트 문자열.
    """
    return f"""
다음 성경 범위에서 설교할 최적의 본문을 선정하고 주제를 개발해주세요.

📖 성경 범위: {bible_range}

위에 제시된 출력 형식을 정확히 따라 작성해주세요.
"""
